{"remainingRequest":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\babel-loader\\lib\\index.js!D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\src\\views\\user\\BillInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\src\\views\\user\\BillInfo.vue","mtime":1698920171851},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\babel.config.js","mtime":1651665518000},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1688268005356},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1688268007045},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1688268005356},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1688268007736}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkucHVzaC5qcyI7CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IGJpbGxEZXRhaWwgZnJvbSAiLi4vcGF5L0JpbGxEZXRhaWwiOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogIkJpbGxJbmZvIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgcXVlcnlJbmZvOiB7CiAgICAgICAgdXNlcklkOiAiIgogICAgICB9LAogICAgICBiaWxsTGlzdDogW3sKICAgICAgICBzeXNTZXNzaW9uOiB7CiAgICAgICAgICBzeXNNb3ZpZTogewogICAgICAgICAgICBtb3ZpZVBvc3RlcjogIiIKICAgICAgICAgIH0sCiAgICAgICAgICBzeXNDaW5lbWE6IHt9LAogICAgICAgICAgc3lzSGFsbDoge30KICAgICAgICB9CiAgICAgIH1dCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0VXNlcigpOwogICAgdGhpcy5nZXRCaWxsTGlzdCgpOwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0VXNlcigpIHsKICAgICAgdGhpcy5xdWVyeUluZm8udXNlcklkID0gSlNPTi5wYXJzZSh3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgibG9naW5Vc2VyIikpLnVzZXJJZDsKICAgIH0sCiAgICBhc3luYyBnZXRCaWxsTGlzdCgpIHsKICAgICAgY29uc3QgX3RoaXMgPSB0aGlzOwogICAgICBhd2FpdCBheGlvcy5nZXQoInN5c0JpbGwiLCB7CiAgICAgICAgcGFyYW1zOiBfdGhpcy5xdWVyeUluZm8KICAgICAgfSkudGhlbihyZXNwID0+IHsKICAgICAgICBfdGhpcy5iaWxsTGlzdCA9IHJlc3AuZGF0YS5kYXRhOwogICAgICB9KTsKICAgICAgZm9yIChsZXQgaWR4IGluIHRoaXMuYmlsbExpc3QpIHsKICAgICAgICB0aGlzLmJpbGxMaXN0W2lkeF0uc3lzU2Vzc2lvbi5zZXNzaW9uRGF0ZSA9IG1vbWVudCh0aGlzLmJpbGxMaXN0W2lkeF0uc3lzU2Vzc2lvbi5zZXNzaW9uRGF0ZSkuZm9ybWF0KCJZWVlZ5bm0TU3mnIhEROaXpSIpOwogICAgICAgIHRoaXMuYmlsbExpc3RbaWR4XS5zeXNTZXNzaW9uLnN5c01vdmllLm1vdmllUG9zdGVyID0gdGhpcy5nbG9iYWwuYmFzZSArIEpTT04ucGFyc2UodGhpcy5iaWxsTGlzdFtpZHhdLnN5c1Nlc3Npb24uc3lzTW92aWUubW92aWVQb3N0ZXIpWzBdOwogICAgICB9CiAgICB9LAogICAgdG9CaWxsRGV0YWlsKGlkKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCIvYmlsbERldGFpbC8iICsgaWQpOwogICAgfSwKICAgIGFzeW5jIGRlbGV0ZUJpbGwoaWQpIHsKICAgICAgY29uc3QgX3RoaXMgPSB0aGlzOwogICAgICBjb25zdCByZXNwID0gYXdhaXQgdGhpcy4kY29uZmlybSgi5q2k5pON5L2c5bCG5rC45LmF5Yig6Zmk6K6i5Y2V5L+h5oGvLOaYr+WQpue7p+e7rT8iLCAi5o+Q56S6IiwgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAi56Gu5a6aIiwKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAi5Y+W5raIIiwKICAgICAgICB0eXBlOiAid2FybmluZyIKICAgICAgfSkuY2F0Y2goZXJyID0+IGVycik7CiAgICAgIGlmIChyZXNwID09PSAiY2FuY2VsIikgewogICAgICAgIHJldHVybiBfdGhpcy4kbWVzc2FnZS5pbmZvKCLlt7Llj5bmtojliKDpmaQiKTsKICAgICAgfQogICAgICBhd2FpdCBheGlvcy5kZWxldGUoInN5c0JpbGwvIiArIGlkKS50aGVuKHJlc3AgPT4gewogICAgICAgIGlmIChyZXNwLmRhdGEuY29kZSAhPT0gMjAwKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCLliKDpmaTlpLHotKXvvIEiKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICBhd2FpdCB0aGlzLmdldEJpbGxMaXN0KCk7CiAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygi5Yig6Zmk5oiQ5Yqf77yBIik7CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["moment","billDetail","name","data","queryInfo","userId","billList","sysSession","sysMovie","moviePoster","sysCinema","sysHall","created","getUser","getBillList","methods","JSON","parse","window","sessionStorage","getItem","_this","axios","get","params","then","resp","idx","sessionDate","format","global","base","toBillDetail","id","$router","push","deleteBill","$confirm","confirmButtonText","cancelButtonText","type","catch","err","$message","info","delete","code","error","success"],"sources":["src/views/user/BillInfo.vue"],"sourcesContent":["<template>\n    <div class=\"bill-list-container\">\n        <div class=\"profile-title\">\n            <i class=\"iconfont icon-r-shield\" style=\"font-size: 28px\"></i>\n            我的订单\n        </div>\n        <div class=\"order-box\" v-for=\"item in billList\" :key=\"item.id\">\n            <div class=\"order-header\">\n                <i\n                    class=\"iconfont icon-r-right\"\n                    style=\"font-size: 26px; margin-right: 10px\"\n                >\n                </i>\n                <span class=\"order-date\">订单时间：{{ item.createTime }}</span>\n                <span class=\"order-id\">订单编号: {{ item.billId }}</span>\n                <span class=\"del-order\" @click=\"deleteBill(item.billId)\">\n                    <i\n                        class=\"iconfont icon-r-delete\"\n                        style=\"font-size: 26px\"\n                    ></i>\n                </span>\n            </div>\n            <div class=\"order-body\">\n                <div class=\"poster\">\n                    <img :src=\"item.sysSession.sysMovie.moviePoster\" />\n                </div>\n                <div class=\"order-content\">\n                    <div class=\"movie-name\">\n                        《{{ item.sysSession.sysMovie.movieName }}》\n                    </div>\n                    <div class=\"cinema-name\">\n                        {{ item.sysSession.sysHall.sysCinema.cinemaName }}\n                    </div>\n                    <div class=\"hall-ticket\">\n                        <span\n                            >放映厅：{{ item.sysSession.sysHall.hallName }}({{\n                                item.sysSession.sysHall.hallCategory\n                            }})</span\n                        >\n                        <span></span>\n                    </div>\n                    <div class=\"show-time\">\n                        播放时间：{{\n                            item.sysSession.sessionDate +\n                            \" \" +\n                            item.sysSession.playTime +\n                            \" - \" +\n                            item.sysSession.endTime\n                        }}\n                    </div>\n                </div>\n                <div class=\"order-price\">\n                    ￥{{\n                        item.sysSession.sessionPrice *\n                        JSON.parse(item.seats).length\n                    }}\n                    ( {{ JSON.parse(item.seats).length }}*{{\n                        item.sysSession.sessionPrice\n                    }}/张 )\n                </div>\n                <div class=\"order-status\">\n                    {{ item.payState ? \"已完成\" : \"未完成\" }}\n                </div>\n                <div class=\"actions\">\n                    <div>\n                        <el-button\n                            @click=\"toBillDetail(item.billId)\"\n                            style=\"font-size: 20px\"\n                        >\n                            <i\n                                class=\"iconfont icon-r-find\"\n                                style=\"font-size: 24px\"\n                            ></i>\n                            详情\n                        </el-button>\n                        <!-- <a  class=\"order-detail\" ></a> -->\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport moment from \"moment\";\nimport billDetail from \"../pay/BillDetail\";\nexport default {\n    name: \"BillInfo\",\n    data() {\n        return {\n            queryInfo: {\n                userId: \"\",\n            },\n            billList: [\n                {\n                    sysSession: {\n                        sysMovie: {\n                            moviePoster: \"\",\n                        },\n                        sysCinema: {},\n                        sysHall: {},\n                    },\n                },\n            ],\n        };\n    },\n    created() {\n        this.getUser();\n        this.getBillList();\n    },\n    methods: {\n        getUser() {\n            this.queryInfo.userId = JSON.parse(\n                window.sessionStorage.getItem(\"loginUser\")\n            ).userId;\n        },\n        async getBillList() {\n            const _this = this;\n            await axios\n                .get(\"sysBill\", { params: _this.queryInfo })\n                .then((resp) => {\n                    _this.billList = resp.data.data;\n                });\n\n            for (let idx in this.billList) {\n                this.billList[idx].sysSession.sessionDate = moment(\n                    this.billList[idx].sysSession.sessionDate\n                ).format(\"YYYY年MM月DD日\");\n                this.billList[idx].sysSession.sysMovie.moviePoster =\n                    this.global.base +\n                    JSON.parse(\n                        this.billList[idx].sysSession.sysMovie.moviePoster\n                    )[0];\n            }\n        },\n        toBillDetail(id) {\n            this.$router.push(\"/billDetail/\" + id);\n        },\n        async deleteBill(id) {\n            const _this = this;\n            const resp = await this.$confirm(\n                \"此操作将永久删除订单信息,是否继续?\",\n                \"提示\",\n                {\n                    confirmButtonText: \"确定\",\n                    cancelButtonText: \"取消\",\n                    type: \"warning\",\n                }\n            ).catch((err) => err);\n            if (resp === \"cancel\") {\n                return _this.$message.info(\"已取消删除\");\n            }\n            await axios.delete(\"sysBill/\" + id).then((resp) => {\n                if (resp.data.code !== 200) {\n                    this.$message.error(\"删除失败！\");\n                }\n            });\n            await this.getBillList();\n            this.$message.success(\"删除成功！\");\n        },\n    },\n};\n</script>\n\n<style scoped>\n.bill-list-container {\n    min-height: 900px;\n}\n\n.profile-title {\n    padding: 26px 0;\n    color: #ec443f;\n    font-size: 18px;\n    border-bottom: 1px solid #e1e1e1;\n    margin-bottom: 30px;\n}\n\n.order-box {\n    border: 1px solid #e5e5e5;\n    margin: 0 40px 30px 0;\n}\n\n.order-box .order-header {\n    background-color: #f7f7f7;\n    font-size: 18px;\n    padding: 16px 20px;\n}\n\n.order-box .order-header .order-date {\n    color: #333;\n    display: inline-block;\n    margin-right: 30px;\n}\n\n.order-box .order-header .order-id {\n    color: #999;\n}\n\n.del-order {\n    float: right;\n}\n\n.order-box .order-body {\n    padding: 20px;\n    padding-right: 0;\n    display: flex;\n}\n\n.order-box .order-body .poster {\n    width: 66px;\n    height: 91px;\n    margin-right: 11px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);\n}\n\n.poster img {\n    width: 100%;\n    height: 100%;\n}\n\n.order-content {\n    width: 49%;\n}\n\n.movie-name {\n    font-size: 16px;\n    font-weight: 700;\n    color: #333;\n    margin: 4px 0 7px -6px;\n}\n\n.cinema-name,\n.hall-ticket {\n    font-size: 12px;\n    color: #999;\n    margin-bottom: 4px;\n}\n\n.show-time {\n    font-size: 12px;\n    color: #f03d37;\n}\n\n.order-price,\n.order-status,\n.actions {\n    font-size: 14px;\n    color: #333;\n    width: 15%;\n    line-height: 95px;\n}\n.order-detail {\n    color: #2d98f3;\n}\na {\n    text-decoration: none;\n    cursor: pointer;\n    color: #333;\n}\n</style>\n"],"mappings":";AAoFA,OAAAA,MAAA;AACA,OAAAC,UAAA;AACA;EACAC,IAAA;EACAC,KAAA;IACA;MACAC,SAAA;QACAC,MAAA;MACA;MACAC,QAAA,GACA;QACAC,UAAA;UACAC,QAAA;YACAC,WAAA;UACA;UACAC,SAAA;UACAC,OAAA;QACA;MACA;IAEA;EACA;EACAC,QAAA;IACA,KAAAC,OAAA;IACA,KAAAC,WAAA;EACA;EACAC,OAAA;IACAF,QAAA;MACA,KAAAT,SAAA,CAAAC,MAAA,GAAAW,IAAA,CAAAC,KAAA,CACAC,MAAA,CAAAC,cAAA,CAAAC,OAAA,aACA,EAAAf,MAAA;IACA;IACA,MAAAS,YAAA;MACA,MAAAO,KAAA;MACA,MAAAC,KAAA,CACAC,GAAA;QAAAC,MAAA,EAAAH,KAAA,CAAAjB;MAAA,GACAqB,IAAA,CAAAC,IAAA;QACAL,KAAA,CAAAf,QAAA,GAAAoB,IAAA,CAAAvB,IAAA,CAAAA,IAAA;MACA;MAEA,SAAAwB,GAAA,SAAArB,QAAA;QACA,KAAAA,QAAA,CAAAqB,GAAA,EAAApB,UAAA,CAAAqB,WAAA,GAAA5B,MAAA,CACA,KAAAM,QAAA,CAAAqB,GAAA,EAAApB,UAAA,CAAAqB,WACA,EAAAC,MAAA;QACA,KAAAvB,QAAA,CAAAqB,GAAA,EAAApB,UAAA,CAAAC,QAAA,CAAAC,WAAA,GACA,KAAAqB,MAAA,CAAAC,IAAA,GACAf,IAAA,CAAAC,KAAA,CACA,KAAAX,QAAA,CAAAqB,GAAA,EAAApB,UAAA,CAAAC,QAAA,CAAAC,WACA;MACA;IACA;IACAuB,aAAAC,EAAA;MACA,KAAAC,OAAA,CAAAC,IAAA,kBAAAF,EAAA;IACA;IACA,MAAAG,WAAAH,EAAA;MACA,MAAAZ,KAAA;MACA,MAAAK,IAAA,cAAAW,QAAA,CACA,sBACA,MACA;QACAC,iBAAA;QACAC,gBAAA;QACAC,IAAA;MACA,CACA,EAAAC,KAAA,CAAAC,GAAA,IAAAA,GAAA;MACA,IAAAhB,IAAA;QACA,OAAAL,KAAA,CAAAsB,QAAA,CAAAC,IAAA;MACA;MACA,MAAAtB,KAAA,CAAAuB,MAAA,cAAAZ,EAAA,EAAAR,IAAA,CAAAC,IAAA;QACA,IAAAA,IAAA,CAAAvB,IAAA,CAAA2C,IAAA;UACA,KAAAH,QAAA,CAAAI,KAAA;QACA;MACA;MACA,WAAAjC,WAAA;MACA,KAAA6B,QAAA,CAAAK,OAAA;IACA;EACA;AACA"}]}