{"remainingRequest":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\src\\views\\user\\BillInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\src\\views\\user\\BillInfo.vue","mtime":1698920179227},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1688268005356},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1688268007045},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1688268005356},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1688268007736}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBtb21lbnQgZnJvbSAibW9tZW50IjsKaW1wb3J0IGJpbGxEZXRhaWwgZnJvbSAiLi4vcGF5L0JpbGxEZXRhaWwiOwpleHBvcnQgZGVmYXVsdCB7CiAgICBuYW1lOiAiQmlsbEluZm8iLAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBxdWVyeUluZm86IHsKICAgICAgICAgICAgICAgIHVzZXJJZDogIiIsCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIGJpbGxMaXN0OiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgc3lzU2Vzc2lvbjogewogICAgICAgICAgICAgICAgICAgICAgICBzeXNNb3ZpZTogewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbW92aWVQb3N0ZXI6ICIiLAogICAgICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgICAgICAgICBzeXNDaW5lbWE6IHt9LAogICAgICAgICAgICAgICAgICAgICAgICBzeXNIYWxsOiB7fSwKICAgICAgICAgICAgICAgICAgICB9LAogICAgICAgICAgICAgICAgfSwKICAgICAgICAgICAgXSwKICAgICAgICB9OwogICAgfSwKICAgIGNyZWF0ZWQoKSB7CiAgICAgICAgdGhpcy5nZXRVc2VyKCk7CiAgICAgICAgdGhpcy5nZXRCaWxsTGlzdCgpOwogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBnZXRVc2VyKCkgewogICAgICAgICAgICB0aGlzLnF1ZXJ5SW5mby51c2VySWQgPSBKU09OLnBhcnNlKAogICAgICAgICAgICAgICAgd2luZG93LnNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpCiAgICAgICAgICAgICkudXNlcklkOwogICAgICAgIH0sCiAgICAgICAgYXN5bmMgZ2V0QmlsbExpc3QoKSB7CiAgICAgICAgICAgIGNvbnN0IF90aGlzID0gdGhpczsKICAgICAgICAgICAgYXdhaXQgYXhpb3MKICAgICAgICAgICAgICAgIC5nZXQoInN5c0JpbGwiLCB7IHBhcmFtczogX3RoaXMucXVlcnlJbmZvIH0pCiAgICAgICAgICAgICAgICAudGhlbigocmVzcCkgPT4gewogICAgICAgICAgICAgICAgICAgIF90aGlzLmJpbGxMaXN0ID0gcmVzcC5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgIGZvciAobGV0IGlkeCBpbiB0aGlzLmJpbGxMaXN0KSB7CiAgICAgICAgICAgICAgICB0aGlzLmJpbGxMaXN0W2lkeF0uc3lzU2Vzc2lvbi5zZXNzaW9uRGF0ZSA9IG1vbWVudCgKICAgICAgICAgICAgICAgICAgICB0aGlzLmJpbGxMaXN0W2lkeF0uc3lzU2Vzc2lvbi5zZXNzaW9uRGF0ZQogICAgICAgICAgICAgICAgKS5mb3JtYXQoIllZWVnlubRNTeaciERE5pelIik7CiAgICAgICAgICAgICAgICB0aGlzLmJpbGxMaXN0W2lkeF0uc3lzU2Vzc2lvbi5zeXNNb3ZpZS5tb3ZpZVBvc3RlciA9CiAgICAgICAgICAgICAgICAgICAgdGhpcy5nbG9iYWwuYmFzZSArCiAgICAgICAgICAgICAgICAgICAgSlNPTi5wYXJzZSgKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5iaWxsTGlzdFtpZHhdLnN5c1Nlc3Npb24uc3lzTW92aWUubW92aWVQb3N0ZXIKICAgICAgICAgICAgICAgICAgICApWzBdOwogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICB0b0JpbGxEZXRhaWwoaWQpIHsKICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi9iaWxsRGV0YWlsLyIgKyBpZCk7CiAgICAgICAgfSwKICAgICAgICBhc3luYyBkZWxldGVCaWxsKGlkKSB7CiAgICAgICAgICAgIGNvbnN0IF90aGlzID0gdGhpczsKICAgICAgICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IHRoaXMuJGNvbmZpcm0oCiAgICAgICAgICAgICAgICAi5q2k5pON5L2c5bCG5rC45LmF5Yig6Zmk6K6i5Y2V5L+h5oGvLOaYr+WQpue7p+e7rT8iLAogICAgICAgICAgICAgICAgIuaPkOekuiIsCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICLnoa7lrpoiLAogICAgICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICLlj5bmtogiLAogICAgICAgICAgICAgICAgICAgIHR5cGU6ICJ3YXJuaW5nIiwKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgKS5jYXRjaCgoZXJyKSA9PiBlcnIpOwogICAgICAgICAgICBpZiAocmVzcCA9PT0gImNhbmNlbCIpIHsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpcy4kbWVzc2FnZS5pbmZvKCLlt7Llj5bmtojliKDpmaQiKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBhd2FpdCBheGlvcy5kZWxldGUoInN5c0JpbGwvIiArIGlkKS50aGVuKChyZXNwKSA9PiB7CiAgICAgICAgICAgICAgICBpZiAocmVzcC5kYXRhLmNvZGUgIT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2UuZXJyb3IoIuWIoOmZpOWksei0pe+8gSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgYXdhaXQgdGhpcy5nZXRCaWxsTGlzdCgpOwogICAgICAgICAgICB0aGlzLiRtZXNzYWdlLnN1Y2Nlc3MoIuWIoOmZpOaIkOWKn++8gSIpOwogICAgICAgIH0sCiAgICB9LAp9Owo="},{"version":3,"sources":["BillInfo.vue"],"names":[],"mappings":";AAgFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BillInfo.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n    <div class=\"bill-list-container\">\n        <div class=\"profile-title\">\n            <i class=\"iconfont icon-r-shield\" style=\"font-size: 28px\"></i>\n            我的订单\n        </div>\n        <div class=\"order-box\" v-for=\"item in billList\" :key=\"item.id\">\n            <div class=\"order-header\">\n                <i\n                    class=\"iconfont icon-r-right\"\n                    style=\"font-size: 26px; margin-right: 10px\"\n                >\n                </i>\n                <span class=\"order-date\">订单时间：{{ item.createTime }}</span>\n                <span class=\"order-id\">订单编号: {{ item.billId }}</span>\n                <span class=\"del-order\" @click=\"deleteBill(item.billId)\">\n                    <i\n                        class=\"iconfont icon-r-delete\"\n                        style=\"font-size: 26px\"\n                    ></i>\n                </span>\n            </div>\n            <div class=\"order-body\">\n                <div class=\"poster\">\n                    <img :src=\"item.sysSession.sysMovie.moviePoster\" />\n                </div>\n                <div class=\"order-content\">\n                    <div class=\"movie-name\">\n                        《{{ item.sysSession.sysMovie.movieName }}》\n                    </div>\n                    <div class=\"cinema-name\">\n                        {{ item.sysSession.sysHall.sysCinema.cinemaName }}\n                    </div>\n                    <div class=\"hall-ticket\">\n                        <span\n                            >放映厅：{{ item.sysSession.sysHall.hallName }}({{\n                                item.sysSession.sysHall.hallCategory\n                            }})</span\n                        >\n                        <span></span>\n                    </div>\n                    <div class=\"show-time\">\n                        播放时间：{{\n                            item.sysSession.sessionDate +\n                            \" \" +\n                            item.sysSession.playTime +\n                            \" - \" +\n                            item.sysSession.endTime\n                        }}\n                    </div>\n                </div>\n                <div class=\"order-price\">\n                    ￥{{\n                        item.sysSession.sessionPrice *\n                        JSON.parse(item.seats).length\n                    }}\n                    ( {{ JSON.parse(item.seats).length }}*{{\n                        item.sysSession.sessionPrice\n                    }}/张 )\n                </div>\n                <div class=\"order-status\">\n                    {{ item.payState ? \"已完成\" : \"未完成\" }}\n                </div>\n                <div class=\"actions\">\n                    <div>\n                        <el-button\n                            @click=\"toBillDetail(item.billId)\"\n                            style=\"font-size: 20px\"\n                        >\n                            详情\n                        </el-button>\n                        <!-- <a  class=\"order-detail\" ></a> -->\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nimport moment from \"moment\";\nimport billDetail from \"../pay/BillDetail\";\nexport default {\n    name: \"BillInfo\",\n    data() {\n        return {\n            queryInfo: {\n                userId: \"\",\n            },\n            billList: [\n                {\n                    sysSession: {\n                        sysMovie: {\n                            moviePoster: \"\",\n                        },\n                        sysCinema: {},\n                        sysHall: {},\n                    },\n                },\n            ],\n        };\n    },\n    created() {\n        this.getUser();\n        this.getBillList();\n    },\n    methods: {\n        getUser() {\n            this.queryInfo.userId = JSON.parse(\n                window.sessionStorage.getItem(\"loginUser\")\n            ).userId;\n        },\n        async getBillList() {\n            const _this = this;\n            await axios\n                .get(\"sysBill\", { params: _this.queryInfo })\n                .then((resp) => {\n                    _this.billList = resp.data.data;\n                });\n\n            for (let idx in this.billList) {\n                this.billList[idx].sysSession.sessionDate = moment(\n                    this.billList[idx].sysSession.sessionDate\n                ).format(\"YYYY年MM月DD日\");\n                this.billList[idx].sysSession.sysMovie.moviePoster =\n                    this.global.base +\n                    JSON.parse(\n                        this.billList[idx].sysSession.sysMovie.moviePoster\n                    )[0];\n            }\n        },\n        toBillDetail(id) {\n            this.$router.push(\"/billDetail/\" + id);\n        },\n        async deleteBill(id) {\n            const _this = this;\n            const resp = await this.$confirm(\n                \"此操作将永久删除订单信息,是否继续?\",\n                \"提示\",\n                {\n                    confirmButtonText: \"确定\",\n                    cancelButtonText: \"取消\",\n                    type: \"warning\",\n                }\n            ).catch((err) => err);\n            if (resp === \"cancel\") {\n                return _this.$message.info(\"已取消删除\");\n            }\n            await axios.delete(\"sysBill/\" + id).then((resp) => {\n                if (resp.data.code !== 200) {\n                    this.$message.error(\"删除失败！\");\n                }\n            });\n            await this.getBillList();\n            this.$message.success(\"删除成功！\");\n        },\n    },\n};\n</script>\n\n<style scoped>\n.bill-list-container {\n    min-height: 900px;\n}\n\n.profile-title {\n    padding: 26px 0;\n    color: #ec443f;\n    font-size: 18px;\n    border-bottom: 1px solid #e1e1e1;\n    margin-bottom: 30px;\n}\n\n.order-box {\n    border: 1px solid #e5e5e5;\n    margin: 0 40px 30px 0;\n}\n\n.order-box .order-header {\n    background-color: #f7f7f7;\n    font-size: 18px;\n    padding: 16px 20px;\n}\n\n.order-box .order-header .order-date {\n    color: #333;\n    display: inline-block;\n    margin-right: 30px;\n}\n\n.order-box .order-header .order-id {\n    color: #999;\n}\n\n.del-order {\n    float: right;\n}\n\n.order-box .order-body {\n    padding: 20px;\n    padding-right: 0;\n    display: flex;\n}\n\n.order-box .order-body .poster {\n    width: 66px;\n    height: 91px;\n    margin-right: 11px;\n    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.12), 0 0 6px rgba(0, 0, 0, 0.04);\n}\n\n.poster img {\n    width: 100%;\n    height: 100%;\n}\n\n.order-content {\n    width: 49%;\n}\n\n.movie-name {\n    font-size: 16px;\n    font-weight: 700;\n    color: #333;\n    margin: 4px 0 7px -6px;\n}\n\n.cinema-name,\n.hall-ticket {\n    font-size: 12px;\n    color: #999;\n    margin-bottom: 4px;\n}\n\n.show-time {\n    font-size: 12px;\n    color: #f03d37;\n}\n\n.order-price,\n.order-status,\n.actions {\n    font-size: 14px;\n    color: #333;\n    width: 15%;\n    line-height: 95px;\n}\n.order-detail {\n    color: #2d98f3;\n}\na {\n    text-decoration: none;\n    cursor: pointer;\n    color: #333;\n}\n</style>\n"]}]}