{"remainingRequest":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\src\\views\\user\\BillInfo.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\src\\views\\user\\BillInfo.vue","mtime":1651665518000},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1688268005356},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\babel-loader\\lib\\index.js","mtime":1688268007045},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1688268005356},{"path":"D:\\Work\\WorkSpace\\GitWorkSpace\\TenShop\\resource\\CinemaManager\\src\\CinemaManagerUserVue\\node_modules\\vue-loader\\lib\\index.js","mtime":1688268007736}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CmltcG9ydCBtb21lbnQgZnJvbSAnbW9tZW50JwppbXBvcnQgYmlsbERldGFpbCBmcm9tICcuLi9wYXkvQmlsbERldGFpbCcKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJCaWxsSW5mbyIsCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHF1ZXJ5SW5mbzogewogICAgICAgIHVzZXJJZDogJycKICAgICAgfSwKICAgICAgYmlsbExpc3Q6IFsKICAgICAgICB7CiAgICAgICAgICBzeXNTZXNzaW9uOiB7CiAgICAgICAgICAgIHN5c01vdmllOiB7CiAgICAgICAgICAgICAgbW92aWVQb3N0ZXI6ICcnCiAgICAgICAgICAgIH0sCiAgICAgICAgICAgIHN5c0NpbmVtYToge30sCiAgICAgICAgICAgIHN5c0hhbGw6IHt9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICBdCiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5nZXRVc2VyKCkKICAgIHRoaXMuZ2V0QmlsbExpc3QoKQogIH0sCiAgbWV0aG9kczogewogICAgZ2V0VXNlcigpIHsKICAgICAgdGhpcy5xdWVyeUluZm8udXNlcklkID0gSlNPTi5wYXJzZSh3aW5kb3cuc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnbG9naW5Vc2VyJykpLnVzZXJJZAogICAgfSwKICAgIGFzeW5jIGdldEJpbGxMaXN0KCkgewogICAgICBjb25zdCBfdGhpcyA9IHRoaXMKICAgICAgYXdhaXQgYXhpb3MuZ2V0KCdzeXNCaWxsJyx7cGFyYW1zOl90aGlzLnF1ZXJ5SW5mb30pLnRoZW4ocmVzcD0+ewogICAgICAgIF90aGlzLmJpbGxMaXN0ID0gcmVzcC5kYXRhLmRhdGEKICAgICAgfSkKCiAgICAgIGZvcihsZXQgaWR4IGluIHRoaXMuYmlsbExpc3QpIHsKICAgICAgICB0aGlzLmJpbGxMaXN0W2lkeF0uc3lzU2Vzc2lvbi5zZXNzaW9uRGF0ZSA9IG1vbWVudCh0aGlzLmJpbGxMaXN0W2lkeF0uc3lzU2Vzc2lvbi5zZXNzaW9uRGF0ZSkuZm9ybWF0KCdZWVlZ5bm0TU3mnIhEROaXpScpCiAgICAgICAgdGhpcy5iaWxsTGlzdFtpZHhdLnN5c1Nlc3Npb24uc3lzTW92aWUubW92aWVQb3N0ZXIgPQogICAgICAgICAgdGhpcy5nbG9iYWwuYmFzZSArIEpTT04ucGFyc2UodGhpcy5iaWxsTGlzdFtpZHhdLnN5c1Nlc3Npb24uc3lzTW92aWUubW92aWVQb3N0ZXIpWzBdCiAgICAgIH0KCiAgICB9LAogICAgdG9CaWxsRGV0YWlsKGlkKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvYmlsbERldGFpbC8nICsgaWQpCiAgICB9LAogICAgYXN5bmMgZGVsZXRlQmlsbChpZCkgewogICAgICBjb25zdCBfdGhpcyA9IHRoaXMKICAgICAgY29uc3QgcmVzcCA9IGF3YWl0IHRoaXMuJGNvbmZpcm0oJ+atpOaTjeS9nOWwhuawuOS5heWIoOmZpOiuouWNleS/oeaBryzmmK/lkKbnu6fnu60/Jywn5o+Q56S6Jyx7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS5jYXRjaChlcnI9PmVycikKICAgICAgaWYgKHJlc3A9PT0iY2FuY2VsIikgewogICAgICAgIHJldHVybiBfdGhpcy4kbWVzc2FnZS5pbmZvKCflt7Llj5bmtojliKDpmaQnKQogICAgICB9CiAgICAgIGF3YWl0IGF4aW9zLmRlbGV0ZSgnc3lzQmlsbC8nK2lkKS50aGVuKHJlc3A9PnsKICAgICAgICBpZiAocmVzcC5kYXRhLmNvZGUgIT09IDIwMCl7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlLmVycm9yKCfliKDpmaTlpLHotKXvvIEnKQogICAgICAgIH0KICAgICAgfSkKICAgICAgYXdhaXQgdGhpcy5nZXRCaWxsTGlzdCgpCiAgICAgIHRoaXMuJG1lc3NhZ2Uuc3VjY2Vzcygn5Yig6Zmk5oiQ5Yqf77yBJykKICAgIH0KICB9Cn0K"},{"version":3,"sources":["BillInfo.vue"],"names":[],"mappings":";AA0CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"BillInfo.vue","sourceRoot":"src/views/user","sourcesContent":["<template>\n  <div class=\"bill-list-container\">\n    <div class=\"profile-title\">我的订单</div>\n    <div class=\"order-box\" v-for=\"item in billList\">\n      <div class=\"order-header\">\n        <span class=\"order-date\">订单时间：{{item.createTime}}</span>\n        <span class=\"order-id\">订单编号: {{item.billId}}</span>\n        <span class=\"del-order\"  @click=\"deleteBill(item.billId)\">\n          <i class=\"el-icon-delete\"></i>\n        </span>\n      </div>\n      <div class=\"order-body\">\n        <div class=\"poster\">\n          <img :src=\"item.sysSession.sysMovie.moviePoster\">\n        </div>\n        <div class=\"order-content\">\n          <div class=\"movie-name\">《{{item.sysSession.sysMovie.movieName}}》</div>\n          <div class=\"cinema-name\">{{item.sysSession.sysHall.sysCinema.cinemaName}}</div>\n          <div class=\"hall-ticket\">\n            <span>放映厅：{{item.sysSession.sysHall.hallName}}({{item.sysSession.sysHall.hallCategory}})</span>\n            <span></span>\n          </div>\n          <div class=\"show-time\">播放时间：{{item.sysSession.sessionDate + ' ' + item.sysSession.playTime + ' - ' + item.sysSession.endTime}}</div>\n        </div>\n        <div class=\"order-price\">\n          ￥{{item.sysSession.sessionPrice * JSON.parse(item.seats).length}} (\n          {{JSON.parse(item.seats).length}}*{{item.sysSession.sessionPrice}}/张 )\n        </div>\n        <div class=\"order-status\">\n          {{item.payState?'已完成':'未完成'}}\n        </div>\n        <div class=\"actions\">\n          <div>\n            <a @click=\"toBillDetail(item.billId)\" class=\"order-detail\" >查看详情</a>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport moment from 'moment'\nimport billDetail from '../pay/BillDetail'\nexport default {\n  name: \"BillInfo\",\n  data() {\n    return {\n      queryInfo: {\n        userId: ''\n      },\n      billList: [\n        {\n          sysSession: {\n            sysMovie: {\n              moviePoster: ''\n            },\n            sysCinema: {},\n            sysHall: {}\n          }\n        }\n      ]\n    }\n  },\n  created() {\n    this.getUser()\n    this.getBillList()\n  },\n  methods: {\n    getUser() {\n      this.queryInfo.userId = JSON.parse(window.sessionStorage.getItem('loginUser')).userId\n    },\n    async getBillList() {\n      const _this = this\n      await axios.get('sysBill',{params:_this.queryInfo}).then(resp=>{\n        _this.billList = resp.data.data\n      })\n\n      for(let idx in this.billList) {\n        this.billList[idx].sysSession.sessionDate = moment(this.billList[idx].sysSession.sessionDate).format('YYYY年MM月DD日')\n        this.billList[idx].sysSession.sysMovie.moviePoster =\n          this.global.base + JSON.parse(this.billList[idx].sysSession.sysMovie.moviePoster)[0]\n      }\n\n    },\n    toBillDetail(id) {\n      this.$router.push('/billDetail/' + id)\n    },\n    async deleteBill(id) {\n      const _this = this\n      const resp = await this.$confirm('此操作将永久删除订单信息,是否继续?','提示',{\n        confirmButtonText: '确定',\n        cancelButtonText: '取消',\n        type: 'warning'\n      }).catch(err=>err)\n      if (resp===\"cancel\") {\n        return _this.$message.info('已取消删除')\n      }\n      await axios.delete('sysBill/'+id).then(resp=>{\n        if (resp.data.code !== 200){\n          this.$message.error('删除失败！')\n        }\n      })\n      await this.getBillList()\n      this.$message.success('删除成功！')\n    }\n  }\n}\n</script>\n\n<style scoped>\n.bill-list-container{\n  min-height: 900px;\n}\n\n.profile-title {\n  padding: 26px 0;\n  color: #ec443f;\n  font-size: 18px;\n  border-bottom: 1px solid #e1e1e1;\n  margin-bottom: 30px;\n}\n\n.order-box {\n  border: 1px solid #e5e5e5;\n  margin: 0 40px 30px 0;\n}\n\n.order-box .order-header {\n  background-color: #f7f7f7;\n  font-size: 14px;\n  padding: 16px 20px;\n}\n\n.order-box .order-header .order-date {\n  color: #333;\n  display: inline-block;\n  margin-right: 30px;\n}\n\n.order-box .order-header .order-id {\n  color: #999;\n}\n\n.del-order{\n  float: right;\n}\n\n.order-box .order-body {\n  padding: 20px;\n  padding-right: 0;\n  display: flex;\n}\n\n.order-box .order-body .poster {\n  width: 66px;\n  height: 91px;\n  margin-right: 11px;\n  box-shadow: 0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04)\n}\n\n.poster img{\n  width: 100%;\n  height: 100%;\n}\n\n.order-content{\n  width: 49%;\n}\n\n.movie-name{\n  font-size: 16px;\n  font-weight: 700;\n  color: #333;\n  margin: 4px 0 7px -6px;\n}\n\n.cinema-name, .hall-ticket {\n  font-size: 12px;\n  color: #999;\n  margin-bottom: 4px;\n}\n\n.show-time {\n  font-size: 12px;\n  color: #f03d37;\n}\n\n.order-price, .order-status, .actions{\n  font-size: 14px;\n  color: #333;\n  width: 15%;\n  line-height: 95px;\n}\n.order-detail {\n  color: #2d98f3;\n}\na {\n  text-decoration: none;\n  cursor: pointer;\n  color: #333;\n}\n</style>\n"]}]}